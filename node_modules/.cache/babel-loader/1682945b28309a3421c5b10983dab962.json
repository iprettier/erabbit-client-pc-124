{"remainingRequest":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\thread-loader\\dist\\cjs.js!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\babel-loader\\lib\\index.js!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\category\\components\\sub-filter.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\category\\components\\sub-filter.vue","mtime":1621243079000},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656924649801},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1656924649783},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\babel-loader\\lib\\index.js","mtime":1656924651984},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656924649801},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1656924653036}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0IHsgcmVmLCB3YXRjaCB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IHVzZVJvdXRlIH0gZnJvbSAndnVlLXJvdXRlcic7CmltcG9ydCB7IGZpbmRTdWJDYXRlZ29yeUZpbHRlciB9IGZyb20gJ0AvYXBpL2NhdGVnb3J5JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTdWJGaWx0ZXInLAogIHNldHVwOiBmdW5jdGlvbiBzZXR1cChwcm9wcywgX3JlZikgewogICAgdmFyIGVtaXQgPSBfcmVmLmVtaXQ7CiAgICB2YXIgcm91dGUgPSB1c2VSb3V0ZSgpOyAvLyDnm5HlkKzkuoznuqfnsbvnm65JROeahOWPmOWMluiOt+WPluetm+mAieaVsOaNrgoKICAgIHZhciBmaWx0ZXJEYXRhID0gcmVmKG51bGwpOwogICAgdmFyIGZpbHRlckxvYWRpbmcgPSByZWYoZmFsc2UpOwogICAgd2F0Y2goZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gcm91dGUucGFyYW1zLmlkOwogICAgfSwgZnVuY3Rpb24gKG5ld1ZhbCkgewogICAgICAvLyDlj5jljJblkI7nmoRJROacieWAvCDkuJQg5aSE5Zyo5LqM57qn57G75ZCN6Lev55Sx5LiLCiAgICAgIGlmIChuZXdWYWwgJiYgIi9jYXRlZ29yeS9zdWIvIi5jb25jYXQobmV3VmFsKSA9PT0gcm91dGUucGF0aCkgewogICAgICAgIGZpbHRlckxvYWRpbmcudmFsdWUgPSB0cnVlOyAvLyDlj5Hor7fmsYLojrflj5bmlbDmja4KCiAgICAgICAgZmluZFN1YkNhdGVnb3J5RmlsdGVyKHJvdXRlLnBhcmFtcy5pZCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgLy8g5q+P5LiA57uE5Y+v6YCJ55qE562b6YCJ5p2h5Lu257y65aSxIOWFqOmDqCDmnaHku7bvvIzlpITnkIbkuIvmlbDmja7liqDkuIrlhajpg6gKICAgICAgICAgIC8vIOe7meavj+S4gOe7hOaVsOaNruWKoOS4iuS4gOS4qumAieS4reeahElECiAgICAgICAgICAvLyAxLiDlk4HniYwKICAgICAgICAgIGRhdGEucmVzdWx0LnNlbGVjdGVkQnJhbmQgPSBudWxsOwogICAgICAgICAgZGF0YS5yZXN1bHQuYnJhbmRzLnVuc2hpZnQoewogICAgICAgICAgICBpZDogbnVsbCwKICAgICAgICAgICAgbmFtZTogJ+WFqOmDqCcKICAgICAgICAgIH0pOyAvLyAyLiDlsZ7mgKcKCiAgICAgICAgICBkYXRhLnJlc3VsdC5zYWxlUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIGl0ZW0uc2VsZWN0ZWRQcm9wID0gbnVsbDsKICAgICAgICAgICAgaXRlbS5wcm9wZXJ0aWVzLnVuc2hpZnQoewogICAgICAgICAgICAgIGlkOiBudWxsLAogICAgICAgICAgICAgIG5hbWU6ICflhajpg6gnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7IC8vIOiuvue9ruS/ruaUueeahOaVsOaNrgoKICAgICAgICAgIGZpbHRlckRhdGEudmFsdWUgPSBkYXRhLnJlc3VsdDsKICAgICAgICAgIGZpbHRlckxvYWRpbmcudmFsdWUgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwgewogICAgICBpbW1lZGlhdGU6IHRydWUKICAgIH0pOyAvLyDojrflj5bnrZvpgInlj4LmlbDnmoTlh73mlbAKCiAgICB2YXIgZ2V0RmlsdGVyUGFyYW1zID0gZnVuY3Rpb24gZ2V0RmlsdGVyUGFyYW1zKCkgewogICAgICB2YXIgb2JqID0gewogICAgICAgIGJyYW5kSWQ6IG51bGwsCiAgICAgICAgYXR0cnM6IFtdCiAgICAgIH07IC8vIOWTgeeJjAoKICAgICAgb2JqLmJyYW5kSWQgPSBmaWx0ZXJEYXRhLnZhbHVlLnNlbGVjdGVkQnJhbmQ7IC8vIOmUgOWUruWxnuaApwoKICAgICAgZmlsdGVyRGF0YS52YWx1ZS5zYWxlUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0uc2VsZWN0ZWRQcm9wKSB7CiAgICAgICAgICB2YXIgcHJvcCA9IGl0ZW0ucHJvcGVydGllcy5maW5kKGZ1bmN0aW9uIChwcm9wKSB7CiAgICAgICAgICAgIHJldHVybiBwcm9wLmlkID09PSBpdGVtLnNlbGVjdGVkUHJvcDsKICAgICAgICAgIH0pOwogICAgICAgICAgb2JqLmF0dHJzLnB1c2goewogICAgICAgICAgICBncm91cE5hbWU6IGl0ZW0ubmFtZSwKICAgICAgICAgICAgcHJvcGVydHlOYW1lOiBwcm9wLm5hbWUKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7IC8vIOWPguiAg+aVsOaNru+8mnticmFuZElkOicnLGF0dHJzOlt7Z3JvdXBOYW1lOicnLHByb3BlcnR5TmFtZTonJ30sLi4uXX0KCiAgICAgIGlmIChvYmouYXR0cnMubGVuZ3RoID09PSAwKSBvYmouYXR0cnMgPSBudWxsOwogICAgICByZXR1cm4gb2JqOwogICAgfTsgLy8gMS4g6K6w5b2V5b2T5YmN6YCJ5oup55qE5ZOB54mMCgoKICAgIHZhciBjaGFuZ2VCcmFuZCA9IGZ1bmN0aW9uIGNoYW5nZUJyYW5kKGJyYW5kSWQpIHsKICAgICAgaWYgKGZpbHRlckRhdGEudmFsdWUuc2VsZWN0ZWRCcmFuZCA9PT0gYnJhbmRJZCkgcmV0dXJuOwogICAgICBmaWx0ZXJEYXRhLnZhbHVlLnNlbGVjdGVkQnJhbmQgPSBicmFuZElkOwogICAgICBlbWl0KCdmaWx0ZXItY2hhbmdlJywgZ2V0RmlsdGVyUGFyYW1zKCkpOwogICAgfTsgLy8gMi4g6K6w5b2V5ZGi6YCJ5oup55qE6ZSA5ZSu5bGe5oCnCgoKICAgIHZhciBjaGFuZ2VQcm9wID0gZnVuY3Rpb24gY2hhbmdlUHJvcChpdGVtLCBwcm9wSWQpIHsKICAgICAgaWYgKGl0ZW0uc2VsZWN0ZWRQcm9wID09PSBwcm9wSWQpIHJldHVybjsKICAgICAgaXRlbS5zZWxlY3RlZFByb3AgPSBwcm9wSWQ7CiAgICAgIGVtaXQoJ2ZpbHRlci1jaGFuZ2UnLCBnZXRGaWx0ZXJQYXJhbXMoKSk7CiAgICB9OwoKICAgIHJldHVybiB7CiAgICAgIGZpbHRlckRhdGE6IGZpbHRlckRhdGEsCiAgICAgIGZpbHRlckxvYWRpbmc6IGZpbHRlckxvYWRpbmcsCiAgICAgIGNoYW5nZUJyYW5kOiBjaGFuZ2VCcmFuZCwKICAgICAgY2hhbmdlUHJvcDogY2hhbmdlUHJvcAogICAgfTsKICB9Cn07"},{"version":3,"sources":["F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\category\\components\\sub-filter.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"sub-filter\" v-if=\"filterData && !filterLoading\">\n    <div class=\"item\">\n      <div class=\"head\">品牌：</div>\n      <div class=\"body\">\n        <a @click=\"changeBrand(item.id)\" :class=\"{active:item.id===filterData.selectedBrand}\" href=\"javascript:;\" v-for=\"item in filterData.brands\" :key=\"item.id\">{{item.name}}</a>\n      </div>\n    </div>\n    <div class=\"item\" v-for=\"item in filterData.saleProperties\" :key=\"item.id\">\n      <div class=\"head\">{{item.name}}：</div>\n      <div class=\"body\">\n        <a @click=\"changeProp(item,prop.id)\" :class=\"{active:prop.id===item.selectedProp}\" href=\"javascript:;\" v-for=\"prop in item.properties\" :key=\"prop.id\">{{prop.name}}</a>\n      </div>\n    </div>\n  </div>\n  <div v-else class=\"sub-filter\">\n    <XtxSkeleton class=\"item\" width=\"800px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"800px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"600px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"600px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"600px\" height=\"40px\"  />\n  </div>\n</template>\n<script>\nimport { ref, watch } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { findSubCategoryFilter } from '@/api/category'\nexport default {\n  name: 'SubFilter',\n  setup (props, { emit }) {\n    const route = useRoute()\n    // 监听二级类目ID的变化获取筛选数据\n    const filterData = ref(null)\n    const filterLoading = ref(false)\n    watch(() => route.params.id, (newVal) => {\n      // 变化后的ID有值 且 处在二级类名路由下\n      if (newVal && `/category/sub/${newVal}` === route.path) {\n        filterLoading.value = true\n        // 发请求获取数据\n        findSubCategoryFilter(route.params.id).then(data => {\n          // 每一组可选的筛选条件缺失 全部 条件，处理下数据加上全部\n          // 给每一组数据加上一个选中的ID\n          // 1. 品牌\n          data.result.selectedBrand = null\n          data.result.brands.unshift({ id: null, name: '全部' })\n          // 2. 属性\n          data.result.saleProperties.forEach(item => {\n            item.selectedProp = null\n            item.properties.unshift({ id: null, name: '全部' })\n          })\n          // 设置修改的数据\n          filterData.value = data.result\n          filterLoading.value = false\n        })\n      }\n    }, { immediate: true })\n\n    // 获取筛选参数的函数\n    const getFilterParams = () => {\n      const obj = { brandId: null, attrs: [] }\n      // 品牌\n      obj.brandId = filterData.value.selectedBrand\n      // 销售属性\n      filterData.value.saleProperties.forEach(item => {\n        if (item.selectedProp) {\n          const prop = item.properties.find(prop => prop.id === item.selectedProp)\n          obj.attrs.push({ groupName: item.name, propertyName: prop.name })\n        }\n      })\n      // 参考数据：{brandId:'',attrs:[{groupName:'',propertyName:''},...]}\n      if (obj.attrs.length === 0) obj.attrs = null\n      return obj\n    }\n\n    // 1. 记录当前选择的品牌\n    const changeBrand = (brandId) => {\n      if (filterData.value.selectedBrand === brandId) return\n      filterData.value.selectedBrand = brandId\n      emit('filter-change', getFilterParams())\n    }\n    // 2. 记录呢选择的销售属性\n    const changeProp = (item, propId) => {\n      if (item.selectedProp === propId) return\n      item.selectedProp = propId\n      emit('filter-change', getFilterParams())\n    }\n\n    return { filterData, filterLoading, changeBrand, changeProp }\n  }\n}\n</script>\n<style scoped lang='less'>\n  // 筛选区\n  .sub-filter {\n    background: #fff;\n    padding: 25px;\n    .item {\n      display: flex;\n      line-height: 40px;\n      .head {\n        width: 80px;\n        color: #999;\n      }\n      .body {\n        flex: 1;\n        a {\n          margin-right: 36px;\n          transition: all .3s;\n          display: inline-block;\n          &.active,\n          &:hover {\n            color: @xtxColor;\n          }\n        }\n      }\n    }\n    .xtx-skeleton {\n      padding: 10px 0;\n    }\n  }\n</style>\n"],"sourceRoot":""}]}