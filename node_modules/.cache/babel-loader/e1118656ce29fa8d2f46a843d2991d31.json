{"remainingRequest":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\thread-loader\\dist\\cjs.js!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\babel-loader\\lib\\index.js!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\login\\callback.vue?vue&type=script&lang=js","dependencies":[{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\login\\callback.vue","mtime":1621243079000},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656924649801},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1656924649783},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\babel-loader\\lib\\index.js","mtime":1656924651984},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656924649801},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1656924653036}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IExvZ2luSGVhZGVyIGZyb20gJy4vY29tcG9uZW50cy9sb2dpbi1oZWFkZXInOwppbXBvcnQgTG9naW5Gb290ZXIgZnJvbSAnLi9jb21wb25lbnRzL2xvZ2luLWZvb3Rlcic7CmltcG9ydCBDYWxsYmFja0JpbmQgZnJvbSAnLi9jb21wb25lbnRzL2NhbGxiYWNrLWJpbmQnOwppbXBvcnQgQ2FsbGJhY2tQYXRjaCBmcm9tICcuL2NvbXBvbmVudHMvY2FsbGJhY2stcGF0Y2gnOwppbXBvcnQgeyByZWYgfSBmcm9tICd2dWUnOwppbXBvcnQgUUMgZnJvbSAncWMnOwppbXBvcnQgeyB1c2VyUVFMb2dpbiB9IGZyb20gJ0AvYXBpL3VzZXInOwppbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICd2dWUtcm91dGVyJzsKaW1wb3J0IE1lc3NhZ2UgZnJvbSAnQC9jb21wb25lbnRzL2xpYnJhcnkvTWVzc2FnZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTG9naW5DYWxsYmFjaycsCiAgY29tcG9uZW50czogewogICAgTG9naW5IZWFkZXI6IExvZ2luSGVhZGVyLAogICAgTG9naW5Gb290ZXI6IExvZ2luRm9vdGVyLAogICAgQ2FsbGJhY2tCaW5kOiBDYWxsYmFja0JpbmQsCiAgICBDYWxsYmFja1BhdGNoOiBDYWxsYmFja1BhdGNoCiAgfSwKICBzZXR1cDogZnVuY3Rpb24gc2V0dXAoKSB7CiAgICB2YXIgaGFzQWNjb3VudCA9IHJlZih0cnVlKTsgLy8g6aaW5YWI77ya6buY6K6k6K6k5Li65bey57uP5rOo5YaM5LiU5bey57uP57uR5a6aCiAgICAvLyDpgJrov4dRUeeahEFQSeiOt+WPlm9wZW5JZOWwseaYr+WQjuWPsOmcgOimgeeahHVuaW9uSWTnhLblkI7ljrvov5vooYznmbvlvZUKICAgIC8vIOWmguaenOaIkOWKn++8mueZu+W9leaIkOWKnwogICAgLy8g5aaC5p6c5aSx6LSl77ya5pS5UVHmnKrlkozlsI/lhZTku5nov5vooYznu5HlrprvvIjmnInluJDlj7fmnKrnu5HlrppRUe+8jOayoeacieW4kOWPt+acque7keWumlFR77yJCgogICAgdmFyIGlzQmluZCA9IHJlZih0cnVlKTsKICAgIHZhciBzdG9yZSA9IHVzZVN0b3JlKCk7CiAgICB2YXIgcm91dGVyID0gdXNlUm91dGVyKCk7CiAgICB2YXIgdW5pb25JZCA9IHJlZihudWxsKTsgLy8g56Gu5L+dUVHlt7Lnu4/nmbvlvZUKCiAgICBpZiAoUUMuTG9naW4uY2hlY2soKSkgewogICAgICAvLyDnrKzkuInmlrnllK/kuIDmoIfor4ZRUeWUr+S4gOagh+ivhgogICAgICBRQy5Mb2dpbi5nZXRNZShmdW5jdGlvbiAob3BlbklkKSB7CiAgICAgICAgdW5pb25JZC52YWx1ZSA9IG9wZW5JZDsgLy8g6K+35rGC5bCP5YWU6bKc5ZCO5Y+w77yM5YGaUVHnmbvlvZUKCiAgICAgICAgdXNlclFRTG9naW4ob3BlbklkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAvLyDnmbvlvZXmiJDlip/vvJpkYXRhLnJlc3VsdCDnlKjmiLfkv6Hmga8KICAgICAgICAgIC8vIDEuIOWtmOWCqOeUqOaIt+S/oeaBrwogICAgICAgICAgdmFyIF9kYXRhJHJlc3VsdCA9IGRhdGEucmVzdWx0LAogICAgICAgICAgICAgIGlkID0gX2RhdGEkcmVzdWx0LmlkLAogICAgICAgICAgICAgIGFjY291bnQgPSBfZGF0YSRyZXN1bHQuYWNjb3VudCwKICAgICAgICAgICAgICBhdmF0YXIgPSBfZGF0YSRyZXN1bHQuYXZhdGFyLAogICAgICAgICAgICAgIG1vYmlsZSA9IF9kYXRhJHJlc3VsdC5tb2JpbGUsCiAgICAgICAgICAgICAgbmlja25hbWUgPSBfZGF0YSRyZXN1bHQubmlja25hbWUsCiAgICAgICAgICAgICAgdG9rZW4gPSBfZGF0YSRyZXN1bHQudG9rZW47CiAgICAgICAgICBzdG9yZS5jb21taXQoJ3VzZXIvc2V0VXNlcicsIHsKICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICBhY2NvdW50OiBhY2NvdW50LAogICAgICAgICAgICBhdmF0YXI6IGF2YXRhciwKICAgICAgICAgICAgbW9iaWxlOiBtb2JpbGUsCiAgICAgICAgICAgIG5pY2tuYW1lOiBuaWNrbmFtZSwKICAgICAgICAgICAgdG9rZW46IHRva2VuCiAgICAgICAgICB9KTsKICAgICAgICAgIHN0b3JlLmRpc3BhdGNoKCdjYXJ0L21lcmdlQ2FydCcpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyAyLiDot7PovazliLDmnaXmupDpobXmiJbogIXpppbpobUKICAgICAgICAgICAgcm91dGVyLnB1c2goc3RvcmUuc3RhdGUudXNlci5yZWRpcmVjdFVybCk7IC8vIDMuIOaIkOWKn+aPkOekugoKICAgICAgICAgICAgTWVzc2FnZSh7CiAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgIHRleHQ6ICdRUeeZu+W9leaIkOWKnycKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgLy8g55m75b2V5aSx6LSl77ya5rKh5pyJ5ZKM5bCP5YWU6bKc57uR5a6aCiAgICAgICAgICBpc0JpbmQudmFsdWUgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgaGFzQWNjb3VudDogaGFzQWNjb3VudCwKICAgICAgaXNCaW5kOiBpc0JpbmQsCiAgICAgIHVuaW9uSWQ6IHVuaW9uSWQKICAgIH07CiAgfQp9Ow=="},{"version":3,"sources":["F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\login\\callback.vue"],"names":[],"mappings":"AA4BA,OAAO,WAAP,MAAwB,2BAAxB;AACA,OAAO,WAAP,MAAwB,2BAAxB;AACA,OAAO,YAAP,MAAyB,4BAAzB;AACA,OAAO,aAAP,MAA0B,6BAA1B;AACA,SAAS,GAAT,QAAoB,KAApB;AACA,OAAO,EAAP,MAAe,IAAf;AACA,SAAS,WAAT,QAA4B,YAA5B;AACA,SAAS,QAAT,QAAyB,MAAzB;AACA,SAAS,SAAT,QAA0B,YAA1B;AACA,OAAO,OAAP,MAAoB,8BAApB;AACA,eAAe;AACb,EAAA,IAAI,EAAE,eADO;AAEb,EAAA,UAAU,EAAE;AAAE,IAAA,WAAW,EAAX,WAAF;AAAe,IAAA,WAAW,EAAX,WAAf;AAA4B,IAAA,YAAY,EAAZ,YAA5B;AAA0C,IAAA,aAAY,EAAZ;AAA1C,GAFC;AAGb,EAAA,KAHa,mBAGJ;AACP,QAAM,UAAS,GAAI,GAAG,CAAC,IAAD,CAAtB,CADO,CAGP;AACA;AACA;AACA;;AACA,QAAM,MAAK,GAAI,GAAG,CAAC,IAAD,CAAlB;AACA,QAAM,KAAI,GAAI,QAAQ,EAAtB;AACA,QAAM,MAAK,GAAI,SAAS,EAAxB;AACA,QAAM,OAAM,GAAI,GAAG,CAAC,IAAD,CAAnB,CAVO,CAWP;;AACA,QAAI,EAAE,CAAC,KAAH,CAAS,KAAT,EAAJ,EAAsB;AACpB;AACA,MAAA,EAAE,CAAC,KAAH,CAAS,KAAT,CAAe,UAAC,MAAD,EAAY;AACzB,QAAA,OAAO,CAAC,KAAR,GAAgB,MAAhB,CADyB,CAEzB;;AACA,QAAA,WAAW,CAAC,MAAD,CAAX,CAAoB,IAApB,CAAyB,UAAA,IAAG,EAAK;AAC/B;AACA;AACA,6BAAyD,IAAI,CAAC,MAA9D;AAAA,cAAQ,EAAR,gBAAQ,EAAR;AAAA,cAAY,OAAZ,gBAAY,OAAZ;AAAA,cAAqB,MAArB,gBAAqB,MAArB;AAAA,cAA6B,MAA7B,gBAA6B,MAA7B;AAAA,cAAqC,QAArC,gBAAqC,QAArC;AAAA,cAA+C,KAA/C,gBAA+C,KAA/C;AACA,UAAA,KAAK,CAAC,MAAN,CAAa,cAAb,EAA6B;AAAE,YAAA,EAAE,EAAF,EAAF;AAAM,YAAA,OAAO,EAAP,OAAN;AAAe,YAAA,MAAM,EAAN,MAAf;AAAuB,YAAA,MAAM,EAAN,MAAvB;AAA+B,YAAA,QAAQ,EAAR,QAA/B;AAAyC,YAAA,KAAI,EAAJ;AAAzC,WAA7B;AACA,UAAA,KAAK,CAAC,QAAN,CAAe,gBAAf,EAAiC,IAAjC,CAAsC,YAAM;AAC5C;AACE,YAAA,MAAM,CAAC,IAAP,CAAY,KAAK,CAAC,KAAN,CAAY,IAAZ,CAAiB,WAA7B,EAF0C,CAG1C;;AACA,YAAA,OAAO,CAAC;AAAE,cAAA,IAAI,EAAE,SAAR;AAAmB,cAAA,IAAI,EAAE;AAAzB,aAAD,CAAP;AACD,WALD;AAMD,SAXD,EAWG,KAXH,CAWS,UAAA,CAAA,EAAK;AACZ;AACA,UAAA,MAAM,CAAC,KAAP,GAAe,KAAf;AACD,SAdD;AAeD,OAlBD;AAmBF;;AAEA,WAAO;AAAE,MAAA,UAAU,EAAV,UAAF;AAAc,MAAA,MAAM,EAAN,MAAd;AAAsB,MAAA,OAAM,EAAN;AAAtB,KAAP;AACF;AAvCa,CAAf","sourcesContent":["<template>\n  <LoginHeader>联合登录</LoginHeader>\n  <section class=\"container\" v-if=\"isBind\">\n    <div class=\"unbind\">\n      <div class=\"loading\"></div>\n    </div>\n  </section>\n  <section class=\"container\" v-else>\n    <nav class=\"tab\">\n      <a @click=\"hasAccount=true\" :class=\"{active:hasAccount}\" href=\"javascript:;\">\n        <i class=\"iconfont icon-bind\" />\n        <span>已有小兔鲜账号，请绑定手机</span>\n      </a>\n      <a @click=\"hasAccount=false\" :class=\"{active:!hasAccount}\" href=\"javascript:;\">\n        <i class=\"iconfont icon-edit\" />\n        <span>没有小兔鲜账号，请完善资料</span>\n      </a>\n    </nav>\n    <div class=\"tab-content\" v-if=\"hasAccount\">\n      <CallbackBind :unionId=\"unionId\" />\n    </div>\n    <div class=\"tab-content\" v-else>\n      <CallbackPatch :unionId=\"unionId\" />\n    </div>\n  </section>\n  <LoginFooter />\n</template>\n<script>\nimport LoginHeader from './components/login-header'\nimport LoginFooter from './components/login-footer'\nimport CallbackBind from './components/callback-bind'\nimport CallbackPatch from './components/callback-patch'\nimport { ref } from 'vue'\nimport QC from 'qc'\nimport { userQQLogin } from '@/api/user'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport Message from '@/components/library/Message'\nexport default {\n  name: 'LoginCallback',\n  components: { LoginHeader, LoginFooter, CallbackBind, CallbackPatch },\n  setup () {\n    const hasAccount = ref(true)\n\n    // 首先：默认认为已经注册且已经绑定\n    // 通过QQ的API获取openId就是后台需要的unionId然后去进行登录\n    // 如果成功：登录成功\n    // 如果失败：改QQ未和小兔仙进行绑定（有帐号未绑定QQ，没有帐号未绑定QQ）\n    const isBind = ref(true)\n    const store = useStore()\n    const router = useRouter()\n    const unionId = ref(null)\n    // 确保QQ已经登录\n    if (QC.Login.check()) {\n      // 第三方唯一标识QQ唯一标识\n      QC.Login.getMe((openId) => {\n        unionId.value = openId\n        // 请求小兔鲜后台，做QQ登录\n        userQQLogin(openId).then(data => {\n          // 登录成功：data.result 用户信息\n          // 1. 存储用户信息\n          const { id, account, avatar, mobile, nickname, token } = data.result\n          store.commit('user/setUser', { id, account, avatar, mobile, nickname, token })\n          store.dispatch('cart/mergeCart').then(() => {\n          // 2. 跳转到来源页或者首页\n            router.push(store.state.user.redirectUrl)\n            // 3. 成功提示\n            Message({ type: 'success', text: 'QQ登录成功' })\n          })\n        }).catch(e => {\n          // 登录失败：没有和小兔鲜绑定\n          isBind.value = false\n        })\n      })\n    }\n\n    return { hasAccount, isBind, unionId }\n  }\n}\n</script>\n<style scoped lang=\"less\">\n.container {\n  padding: 25px 0;\n  position: relative;\n  height: 730px;\n  .unbind {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    padding: 25px 0;\n    z-index: 99;\n    .loading {\n      height: 100%;\n      background: #fff url(../../assets/images/load.gif) no-repeat center / 100px 100px;\n    }\n  }\n}\n.tab {\n  background: #fff;\n  height: 80px;\n  padding-top: 40px;\n  font-size: 18px;\n  text-align: center;\n  a {\n    color: #666;\n    display: inline-block;\n    width: 350px;\n    line-height: 40px;\n    border-bottom: 2px solid #e4e4e4;\n    i {\n      font-size: 22px;\n      vertical-align: middle;\n    }\n    span {\n      vertical-align: middle;\n      margin-left: 4px;\n    }\n    &.active {\n      color: @xtxColor;\n      border-color: @xtxColor;\n    }\n  }\n}\n.tab-content {\n  min-height: 600px;\n  background: #fff;\n}\n</style>\n"],"sourceRoot":""}]}