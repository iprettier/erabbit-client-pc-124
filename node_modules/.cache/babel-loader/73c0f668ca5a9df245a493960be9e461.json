{"remainingRequest":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\thread-loader\\dist\\cjs.js!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\babel-loader\\lib\\index.js!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\templateLoader.js??ref--6!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\category\\components\\sub-filter.vue?vue&type=template&id=31ff1e6f&scoped=true","dependencies":[{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\category\\components\\sub-filter.vue","mtime":1621243079000},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656924649801},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1656924649783},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\babel-loader\\lib\\index.js","mtime":1656924651984},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1656924654079},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656924649801},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1656924653036}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCB7IGNyZWF0ZVZOb2RlIGFzIF9jcmVhdGVWTm9kZSwgcmVuZGVyTGlzdCBhcyBfcmVuZGVyTGlzdCwgRnJhZ21lbnQgYXMgX0ZyYWdtZW50LCBvcGVuQmxvY2sgYXMgX29wZW5CbG9jaywgY3JlYXRlQmxvY2sgYXMgX2NyZWF0ZUJsb2NrLCB0b0Rpc3BsYXlTdHJpbmcgYXMgX3RvRGlzcGxheVN0cmluZywgY3JlYXRlQ29tbWVudFZOb2RlIGFzIF9jcmVhdGVDb21tZW50Vk5vZGUsIHJlc29sdmVDb21wb25lbnQgYXMgX3Jlc29sdmVDb21wb25lbnQsIHdpdGhTY29wZUlkIGFzIF93aXRoU2NvcGVJZCwgcHVzaFNjb3BlSWQgYXMgX3B1c2hTY29wZUlkLCBwb3BTY29wZUlkIGFzIF9wb3BTY29wZUlkIH0gZnJvbSAidnVlIjsKCnZhciBfd2l0aElkID0gLyojX19QVVJFX18qL193aXRoU2NvcGVJZCgiZGF0YS12LTMxZmYxZTZmIik7CgpfcHVzaFNjb3BlSWQoImRhdGEtdi0zMWZmMWU2ZiIpOwoKdmFyIF9ob2lzdGVkXzEgPSB7CiAga2V5OiAwLAogIGNsYXNzOiAic3ViLWZpbHRlciIKfTsKdmFyIF9ob2lzdGVkXzIgPSB7CiAgY2xhc3M6ICJpdGVtIgp9OwoKdmFyIF9ob2lzdGVkXzMgPSAvKiNfX1BVUkVfXyovX2NyZWF0ZVZOb2RlKCJkaXYiLCB7CiAgY2xhc3M6ICJoZWFkIgp9LCAi5ZOB54mM77yaIiwgLTEpOwoKdmFyIF9ob2lzdGVkXzQgPSB7CiAgY2xhc3M6ICJib2R5Igp9Owp2YXIgX2hvaXN0ZWRfNSA9IHsKICBjbGFzczogImhlYWQiCn07CnZhciBfaG9pc3RlZF82ID0gewogIGNsYXNzOiAiYm9keSIKfTsKdmFyIF9ob2lzdGVkXzcgPSB7CiAga2V5OiAxLAogIGNsYXNzOiAic3ViLWZpbHRlciIKfTsKCl9wb3BTY29wZUlkKCk7CgpleHBvcnQgdmFyIHJlbmRlciA9IC8qI19fUFVSRV9fKi9fd2l0aElkKGZ1bmN0aW9uIChfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICB2YXIgX2NvbXBvbmVudF9YdHhTa2VsZXRvbiA9IF9yZXNvbHZlQ29tcG9uZW50KCJYdHhTa2VsZXRvbiIpOwoKICByZXR1cm4gJHNldHVwLmZpbHRlckRhdGEgJiYgISRzZXR1cC5maWx0ZXJMb2FkaW5nID8gKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUJsb2NrKCJkaXYiLCBfaG9pc3RlZF8xLCBbX2NyZWF0ZVZOb2RlKCJkaXYiLCBfaG9pc3RlZF8yLCBbX2hvaXN0ZWRfMywgX2NyZWF0ZVZOb2RlKCJkaXYiLCBfaG9pc3RlZF80LCBbKF9vcGVuQmxvY2sodHJ1ZSksIF9jcmVhdGVCbG9jayhfRnJhZ21lbnQsIG51bGwsIF9yZW5kZXJMaXN0KCRzZXR1cC5maWx0ZXJEYXRhLmJyYW5kcywgZnVuY3Rpb24gKGl0ZW0pIHsKICAgIHJldHVybiBfb3BlbkJsb2NrKCksIF9jcmVhdGVCbG9jaygiYSIsIHsKICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygkZXZlbnQpIHsKICAgICAgICByZXR1cm4gJHNldHVwLmNoYW5nZUJyYW5kKGl0ZW0uaWQpOwogICAgICB9LAogICAgICBjbGFzczogewogICAgICAgIGFjdGl2ZTogaXRlbS5pZCA9PT0gJHNldHVwLmZpbHRlckRhdGEuc2VsZWN0ZWRCcmFuZAogICAgICB9LAogICAgICBocmVmOiAiamF2YXNjcmlwdDo7IiwKICAgICAga2V5OiBpdGVtLmlkCiAgICB9LCBfdG9EaXNwbGF5U3RyaW5nKGl0ZW0ubmFtZSksIDExLCBbIm9uQ2xpY2siXSk7CiAgfSksIDEyOCkpXSldKSwgKF9vcGVuQmxvY2sodHJ1ZSksIF9jcmVhdGVCbG9jayhfRnJhZ21lbnQsIG51bGwsIF9yZW5kZXJMaXN0KCRzZXR1cC5maWx0ZXJEYXRhLnNhbGVQcm9wZXJ0aWVzLCBmdW5jdGlvbiAoaXRlbSkgewogICAgcmV0dXJuIF9vcGVuQmxvY2soKSwgX2NyZWF0ZUJsb2NrKCJkaXYiLCB7CiAgICAgIGNsYXNzOiAiaXRlbSIsCiAgICAgIGtleTogaXRlbS5pZAogICAgfSwgW19jcmVhdGVWTm9kZSgiZGl2IiwgX2hvaXN0ZWRfNSwgX3RvRGlzcGxheVN0cmluZyhpdGVtLm5hbWUpICsgIu+8miIsIDEpLCBfY3JlYXRlVk5vZGUoImRpdiIsIF9ob2lzdGVkXzYsIFsoX29wZW5CbG9jayh0cnVlKSwgX2NyZWF0ZUJsb2NrKF9GcmFnbWVudCwgbnVsbCwgX3JlbmRlckxpc3QoaXRlbS5wcm9wZXJ0aWVzLCBmdW5jdGlvbiAocHJvcCkgewogICAgICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soImEiLCB7CiAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygkZXZlbnQpIHsKICAgICAgICAgIHJldHVybiAkc2V0dXAuY2hhbmdlUHJvcChpdGVtLCBwcm9wLmlkKTsKICAgICAgICB9LAogICAgICAgIGNsYXNzOiB7CiAgICAgICAgICBhY3RpdmU6IHByb3AuaWQgPT09IGl0ZW0uc2VsZWN0ZWRQcm9wCiAgICAgICAgfSwKICAgICAgICBocmVmOiAiamF2YXNjcmlwdDo7IiwKICAgICAgICBrZXk6IHByb3AuaWQKICAgICAgfSwgX3RvRGlzcGxheVN0cmluZyhwcm9wLm5hbWUpLCAxMSwgWyJvbkNsaWNrIl0pOwogICAgfSksIDEyOCkpXSldKTsKICB9KSwgMTI4KSldKSkgOiAoX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soImRpdiIsIF9ob2lzdGVkXzcsIFtfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9YdHhTa2VsZXRvbiwgewogICAgY2xhc3M6ICJpdGVtIiwKICAgIHdpZHRoOiAiODAwcHgiLAogICAgaGVpZ2h0OiAiNDBweCIKICB9KSwgX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfWHR4U2tlbGV0b24sIHsKICAgIGNsYXNzOiAiaXRlbSIsCiAgICB3aWR0aDogIjgwMHB4IiwKICAgIGhlaWdodDogIjQwcHgiCiAgfSksIF9jcmVhdGVWTm9kZShfY29tcG9uZW50X1h0eFNrZWxldG9uLCB7CiAgICBjbGFzczogIml0ZW0iLAogICAgd2lkdGg6ICI2MDBweCIsCiAgICBoZWlnaHQ6ICI0MHB4IgogIH0pLCBfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9YdHhTa2VsZXRvbiwgewogICAgY2xhc3M6ICJpdGVtIiwKICAgIHdpZHRoOiAiNjAwcHgiLAogICAgaGVpZ2h0OiAiNDBweCIKICB9KSwgX2NyZWF0ZVZOb2RlKF9jb21wb25lbnRfWHR4U2tlbGV0b24sIHsKICAgIGNsYXNzOiAiaXRlbSIsCiAgICB3aWR0aDogIjYwMHB4IiwKICAgIGhlaWdodDogIjQwcHgiCiAgfSldKSk7Cn0pOw=="},{"version":3,"sources":["F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\category\\components\\sub-filter.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"sub-filter\" v-if=\"filterData && !filterLoading\">\n    <div class=\"item\">\n      <div class=\"head\">品牌：</div>\n      <div class=\"body\">\n        <a @click=\"changeBrand(item.id)\" :class=\"{active:item.id===filterData.selectedBrand}\" href=\"javascript:;\" v-for=\"item in filterData.brands\" :key=\"item.id\">{{item.name}}</a>\n      </div>\n    </div>\n    <div class=\"item\" v-for=\"item in filterData.saleProperties\" :key=\"item.id\">\n      <div class=\"head\">{{item.name}}：</div>\n      <div class=\"body\">\n        <a @click=\"changeProp(item,prop.id)\" :class=\"{active:prop.id===item.selectedProp}\" href=\"javascript:;\" v-for=\"prop in item.properties\" :key=\"prop.id\">{{prop.name}}</a>\n      </div>\n    </div>\n  </div>\n  <div v-else class=\"sub-filter\">\n    <XtxSkeleton class=\"item\" width=\"800px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"800px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"600px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"600px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"600px\" height=\"40px\"  />\n  </div>\n</template>\n<script>\nimport { ref, watch } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { findSubCategoryFilter } from '@/api/category'\nexport default {\n  name: 'SubFilter',\n  setup (props, { emit }) {\n    const route = useRoute()\n    // 监听二级类目ID的变化获取筛选数据\n    const filterData = ref(null)\n    const filterLoading = ref(false)\n    watch(() => route.params.id, (newVal) => {\n      // 变化后的ID有值 且 处在二级类名路由下\n      if (newVal && `/category/sub/${newVal}` === route.path) {\n        filterLoading.value = true\n        // 发请求获取数据\n        findSubCategoryFilter(route.params.id).then(data => {\n          // 每一组可选的筛选条件缺失 全部 条件，处理下数据加上全部\n          // 给每一组数据加上一个选中的ID\n          // 1. 品牌\n          data.result.selectedBrand = null\n          data.result.brands.unshift({ id: null, name: '全部' })\n          // 2. 属性\n          data.result.saleProperties.forEach(item => {\n            item.selectedProp = null\n            item.properties.unshift({ id: null, name: '全部' })\n          })\n          // 设置修改的数据\n          filterData.value = data.result\n          filterLoading.value = false\n        })\n      }\n    }, { immediate: true })\n\n    // 获取筛选参数的函数\n    const getFilterParams = () => {\n      const obj = { brandId: null, attrs: [] }\n      // 品牌\n      obj.brandId = filterData.value.selectedBrand\n      // 销售属性\n      filterData.value.saleProperties.forEach(item => {\n        if (item.selectedProp) {\n          const prop = item.properties.find(prop => prop.id === item.selectedProp)\n          obj.attrs.push({ groupName: item.name, propertyName: prop.name })\n        }\n      })\n      // 参考数据：{brandId:'',attrs:[{groupName:'',propertyName:''},...]}\n      if (obj.attrs.length === 0) obj.attrs = null\n      return obj\n    }\n\n    // 1. 记录当前选择的品牌\n    const changeBrand = (brandId) => {\n      if (filterData.value.selectedBrand === brandId) return\n      filterData.value.selectedBrand = brandId\n      emit('filter-change', getFilterParams())\n    }\n    // 2. 记录呢选择的销售属性\n    const changeProp = (item, propId) => {\n      if (item.selectedProp === propId) return\n      item.selectedProp = propId\n      emit('filter-change', getFilterParams())\n    }\n\n    return { filterData, filterLoading, changeBrand, changeProp }\n  }\n}\n</script>\n<style scoped lang='less'>\n  // 筛选区\n  .sub-filter {\n    background: #fff;\n    padding: 25px;\n    .item {\n      display: flex;\n      line-height: 40px;\n      .head {\n        width: 80px;\n        color: #999;\n      }\n      .body {\n        flex: 1;\n        a {\n          margin-right: 36px;\n          transition: all .3s;\n          display: inline-block;\n          &.active,\n          &:hover {\n            color: @xtxColor;\n          }\n        }\n      }\n    }\n    .xtx-skeleton {\n      padding: 10px 0;\n    }\n  }\n</style>\n"],"sourceRoot":""}]}