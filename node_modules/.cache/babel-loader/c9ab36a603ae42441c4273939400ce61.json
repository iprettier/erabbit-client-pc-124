{"remainingRequest":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\babel-loader\\lib\\index.js!E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\templateLoader.js??ref--6!E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\src\\components\\library\\xtx-city.vue?vue&type=template&id=6e13a280&scoped=true","dependencies":[{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\src\\components\\library\\xtx-city.vue","mtime":1621243079000},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656924649801},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\babel-loader\\lib\\index.js","mtime":1656924651984},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1656924654079},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656924649801},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1656924653036}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCB7IHRvRGlzcGxheVN0cmluZyBhcyBfdG9EaXNwbGF5U3RyaW5nLCBvcGVuQmxvY2sgYXMgX29wZW5CbG9jaywgY3JlYXRlQmxvY2sgYXMgX2NyZWF0ZUJsb2NrLCBjcmVhdGVDb21tZW50Vk5vZGUgYXMgX2NyZWF0ZUNvbW1lbnRWTm9kZSwgY3JlYXRlVk5vZGUgYXMgX2NyZWF0ZVZOb2RlLCByZW5kZXJMaXN0IGFzIF9yZW5kZXJMaXN0LCBGcmFnbWVudCBhcyBfRnJhZ21lbnQsIHdpdGhTY29wZUlkIGFzIF93aXRoU2NvcGVJZCwgcHVzaFNjb3BlSWQgYXMgX3B1c2hTY29wZUlkLCBwb3BTY29wZUlkIGFzIF9wb3BTY29wZUlkIH0gZnJvbSAidnVlIjsKCnZhciBfd2l0aElkID0gLyojX19QVVJFX18qL193aXRoU2NvcGVJZCgiZGF0YS12LTZlMTNhMjgwIik7CgpfcHVzaFNjb3BlSWQoImRhdGEtdi02ZTEzYTI4MCIpOwoKdmFyIF9ob2lzdGVkXzEgPSB7CiAgY2xhc3M6ICJ4dHgtY2l0eSIsCiAgcmVmOiAidGFyZ2V0Igp9Owp2YXIgX2hvaXN0ZWRfMiA9IHsKICBrZXk6IDAsCiAgY2xhc3M6ICJwbGFjZWhvbGRlciIKfTsKdmFyIF9ob2lzdGVkXzMgPSB7CiAga2V5OiAxLAogIGNsYXNzOiAidmFsdWUiCn07Cgp2YXIgX2hvaXN0ZWRfNCA9IC8qI19fUFVSRV9fKi9fY3JlYXRlVk5vZGUoImkiLCB7CiAgY2xhc3M6ICJpY29uZm9udCBpY29uLWFuZ2xlLWRvd24iCn0sIG51bGwsIC0xCi8qIEhPSVNURUQgKi8KKTsKCnZhciBfaG9pc3RlZF81ID0gewogIGtleTogMCwKICBjbGFzczogIm9wdGlvbiIKfTsKdmFyIF9ob2lzdGVkXzYgPSB7CiAga2V5OiAwLAogIGNsYXNzOiAibG9hZGluZyIKfTsKCl9wb3BTY29wZUlkKCk7CgpleHBvcnQgdmFyIHJlbmRlciA9IC8qI19fUFVSRV9fKi9fd2l0aElkKGZ1bmN0aW9uIChfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soImRpdiIsIF9ob2lzdGVkXzEsIFtfY3JlYXRlVk5vZGUoImRpdiIsIHsKICAgIGNsYXNzOiBbInNlbGVjdCIsIHsKICAgICAgYWN0aXZlOiAkc2V0dXAudmlzaWJsZQogICAgfV0sCiAgICBvbkNsaWNrOiBfY2FjaGVbMV0gfHwgKF9jYWNoZVsxXSA9IGZ1bmN0aW9uICgkZXZlbnQpIHsKICAgICAgcmV0dXJuICRzZXR1cC50b2dnbGUoKTsKICAgIH0pCiAgfSwgWyEkcHJvcHMuZnVsbExvY2F0aW9uID8gKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUJsb2NrKCJzcGFuIiwgX2hvaXN0ZWRfMiwgX3RvRGlzcGxheVN0cmluZygkcHJvcHMucGxhY2Vob2xkZXIpLCAxCiAgLyogVEVYVCAqLwogICkpIDogKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUJsb2NrKCJzcGFuIiwgX2hvaXN0ZWRfMywgX3RvRGlzcGxheVN0cmluZygkcHJvcHMuZnVsbExvY2F0aW9uKSwgMQogIC8qIFRFWFQgKi8KICApKSwgX2hvaXN0ZWRfNF0sIDIKICAvKiBDTEFTUyAqLwogICksICRzZXR1cC52aXNpYmxlID8gKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUJsb2NrKCJkaXYiLCBfaG9pc3RlZF81LCBbJHNldHVwLmxvYWRpbmcgPyAoX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soImRpdiIsIF9ob2lzdGVkXzYpKSA6IChfb3BlbkJsb2NrKHRydWUpLCBfY3JlYXRlQmxvY2soX0ZyYWdtZW50LCB7CiAgICBrZXk6IDEKICB9LCBfcmVuZGVyTGlzdCgkc2V0dXAuY3Vyckxpc3QsIGZ1bmN0aW9uIChpdGVtKSB7CiAgICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlQmxvY2soInNwYW4iLCB7CiAgICAgIGNsYXNzOiAiZWxsaXBzaXMiLAogICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKCRldmVudCkgewogICAgICAgIHJldHVybiAkc2V0dXAuY2hhbmdlSXRlbShpdGVtKTsKICAgICAgfSwKICAgICAga2V5OiBpdGVtLmNvZGUKICAgIH0sIF90b0Rpc3BsYXlTdHJpbmcoaXRlbS5uYW1lKSwgOQogICAgLyogVEVYVCwgUFJPUFMgKi8KICAgICwgWyJvbkNsaWNrIl0pOwogIH0pLCAxMjgKICAvKiBLRVlFRF9GUkFHTUVOVCAqLwogICkpXSkpIDogX2NyZWF0ZUNvbW1lbnRWTm9kZSgidi1pZiIsIHRydWUpXSwgNTEyCiAgLyogTkVFRF9QQVRDSCAqLwogICk7Cn0pOw=="},{"version":3,"sources":["E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\src\\components\\library\\xtx-city.vue"],"names":[],"mappings":";;;;;;;;AACO,EAAA,KAAK,EAAC,U;AAAW,EAAA,GAAG,EAAC;;;;AAEK,EAAA,KAAK,EAAC;;;;AACpB,EAAA,KAAK,EAAC;;;8BACnB,YAAA,CAAwC,GAAxC,EAAwC;AAArC,EAAA,KAAK,EAAC;AAA+B,CAAxC,EAAmC,IAAnC,EAAmC,CAAA;AAAA;AAAnC,C;;;;AAEG,EAAA,KAAK,EAAC;;;;AACW,EAAA,KAAK,EAAC;;;;;;uBAP9B,YAAA,CAYM,KAZN,EAAA,UAAA,EAYM,CAXJ,YAAA,CAIM,KAJN,EAIM;AAJD,IAAA,KAAK,EAAA,CAAC,QAAD,EAAS;AAAA,MAAA,MAAA,EAAmC,MAAA,CAAA;AAAnC,KAAT,CAIJ;AAJe,IAAA,OAAK,EAAA,MAAA,CAAA,CAAA,CAAA,KAAA,MAAA,CAAA,CAAA,CAAA,GAAA,UAAA,MAAA;AAAA,aAAE,MAAA,CAAA,MAAA,EAAF;AAAA,KAAA;AAIpB,GAJN,E,EACe,MAAA,CAAA,Y,kBAAb,YAAA,CAAqE,MAArE,EAAA,UAAA,EAAqE,gBAAA,CAApB,MAAA,CAAA,WAAoB,CAArE,EAA4D;AAAA;AAA5D,G,mBACA,YAAA,CAAkD,MAAlD,EAAA,UAAA,EAAkD,gBAAA,CAArB,MAAA,CAAA,YAAqB,CAAlD,EAAyC;AAAA;AAAzC,G,GACA,U,CAHF,E;;AAAA,GAWI,EANsB,MAAA,CAAA,O,kBAA1B,YAAA,CAKM,KALN,EAAA,UAAA,EAKM,CAJO,MAAA,CAAA,O,kBAAX,YAAA,CAA0C,KAA1C,EAAA,UAAA,C,uBAEE,YAAA,CAA+G,SAA/G,EAA+G;AAAA,IAAA,GAAA,EAAA;AAAA,GAA/G,EAA+G,WAAA,CAA/C,MAAA,CAAA,QAA+C,EAAvC,UAAhB,IAAgB,EAAZ;yBAA5D,YAAA,CAA+G,MAA/G,EAA+G;AAAzG,MAAA,KAAK,EAAC,UAAmG;AAAvF,MAAA,OAAK,EAAA,iBAAA,MAAA;AAAA,eAAE,MAAA,CAAA,UAAA,CAAW,IAAX,CAAF;AAAA,OAAkF;AAApC,MAAA,GAAG,EAAE,IAAI,CAAC;AAA0B,KAA/G,E,iBAA6F,IAAI,CAAC,I,CAAlG,EAAsG;AAAA;AAAtG,MAAsG,CAAA,SAAA,CAAtG,C;GAA+G,CAA/G,E;;AAAA,G,CAEE,CALN,C,qCAMI,CAZN,E;;AAAA,G","sourcesContent":["<template>\n  <div class=\"xtx-city\" ref=\"target\">\n    <div class=\"select\" @click=\"toggle()\" :class=\"{active:visible}\">\n      <span v-if=\"!fullLocation\" class=\"placeholder\">{{placeholder}}</span>\n      <span v-else class=\"value\">{{fullLocation}}</span>\n      <i class=\"iconfont icon-angle-down\"></i>\n    </div>\n    <div class=\"option\" v-if=\"visible\">\n      <div v-if=\"loading\" class=\"loading\"></div>\n      <template v-else>\n        <span class=\"ellipsis\" @click=\"changeItem(item)\" v-for=\"item in currList\" :key=\"item.code\">{{item.name}}</span>\n      </template>\n    </div>\n  </div>\n</template>\n<script>\nimport { computed, reactive, ref } from 'vue'\nimport { onClickOutside } from '@vueuse/core'\nimport axios from 'axios'\nexport default {\n  name: 'XtxCity',\n  props: {\n    fullLocation: {\n      type: String,\n      default: ''\n    },\n    placeholder: {\n      type: String,\n      defulat: '请选择配送地址'\n    }\n  },\n  setup (props, { emit }) {\n    // 显示隐藏数据\n    const visible = ref(false)\n\n    // 所有省市区数据\n    const allCityData = ref([])\n    // 正在加载数据\n    const loading = ref(false)\n\n    // 提供打开和关闭函数\n    const open = () => {\n      visible.value = true\n      // 获取地区数据\n      loading.value = true\n      getCityData().then(data => {\n        allCityData.value = data\n        loading.value = false\n      })\n      // 清空之前选择\n      for (const key in changeResult) {\n        changeResult[key] = ''\n      }\n    }\n    const close = () => {\n      visible.value = false\n    }\n    // 提供一个切换函数给select使用\n    const toggle = () => {\n      visible.value ? close() : open()\n    }\n    // 实现点击组件外部元素进行关闭操作\n    const target = ref(null)\n    onClickOutside(target, () => {\n      // 参数1：监听那个元素\n      // 参数2：点击了该元素外的其他地方触发的函数\n      close()\n    })\n\n    // 实现计算属性：获取当前显示的地区数组\n    const currList = computed(() => {\n      // 默认省一级\n      let list = allCityData.value\n      // 可能：市一级\n      if (changeResult.provinceCode && changeResult.provinceName) {\n        list = list.find(p => p.code === changeResult.provinceCode).areaList\n      }\n      // 可能：县地区一级\n      if (changeResult.cityCode && changeResult.cityName) {\n        list = list.find(c => c.code === changeResult.cityCode).areaList\n      }\n      return list\n    })\n\n    // 定义选择的 省市区 数据\n    const changeResult = reactive({\n      provinceCode: '',\n      provinceName: '',\n      cityCode: '',\n      cityName: '',\n      countyCode: '',\n      countyName: '',\n      fullLocation: ''\n    })\n    // 当你点击按钮的时候记录\n    const changeItem = (item) => {\n      if (item.level === 0) {\n        // 省\n        changeResult.provinceCode = item.code\n        changeResult.provinceName = item.name\n      }\n      if (item.level === 1) {\n        // 市\n        changeResult.cityCode = item.code\n        changeResult.cityName = item.name\n      }\n      if (item.level === 2) {\n        // 地区\n        changeResult.countyCode = item.code\n        changeResult.countyName = item.name\n        // 完整路径\n        changeResult.fullLocation = `${changeResult.provinceName} ${changeResult.cityName} ${changeResult.countyName}`\n        // 这是最后一级，选完了，关闭对话框，通知父组件数据\n        close()\n        emit('change', changeResult)\n      }\n    }\n\n    return { visible, toggle, target, loading, currList, changeItem }\n  }\n}\n// 获取省市区数据函数\nconst getCityData = () => {\n  // 数据：https://yjy-oss-files.oss-cn-zhangjiakou.aliyuncs.com/tuxian/area.json\n  // 1. 当本地没有缓存，发请求获取数据\n  // 2. 当本地缓存，取出本地数据\n  // 返回promise在then获取数据，这里可能是异步操作可能是同步操作\n  return new Promise((resolve, reject) => {\n    // 约定：数据存储在window上的cityData字段\n    if (window.cityData) {\n      resolve(window.cityData)\n    } else {\n      const url = 'https://yjy-oss-files.oss-cn-zhangjiakou.aliyuncs.com/tuxian/area.json'\n      axios.get(url).then(res => {\n        // 缓存\n        window.cityData = res.data\n        resolve(res.data)\n      })\n    }\n  })\n}\n</script>\n<style scoped lang=\"less\">\n.xtx-city {\n  display: inline-block;\n  position: relative;\n  z-index: 400;\n  .select {\n    border: 1px solid #e4e4e4;\n    height: 30px;\n    padding: 0 5px;\n    line-height: 28px;\n    cursor: pointer;\n    &.active {\n      background: #fff;\n    }\n    .placeholder {\n      color: #999;\n    }\n    .value {\n      color: #666;\n      font-size: 12px;\n    }\n    i {\n      font-size: 12px;\n      margin-left: 5px;\n    }\n  }\n  .option {\n    width: 542px;\n    border: 1px solid #e4e4e4;\n    position: absolute;\n    left: 0;\n    top: 29px;\n    background: #fff;\n    min-height: 30px;\n    line-height: 30px;\n    display: flex;\n    flex-wrap: wrap;\n    padding: 10px;\n    > span {\n      width: 130px;\n      text-align: center;\n      cursor: pointer;\n      border-radius: 4px;\n      padding: 0 3px;\n      &:hover {\n        background: #f5f5f5;\n      }\n    }\n    .loading {\n      height: 290px;\n      width: 100%;\n      background: url(../../assets/images/loading.gif) no-repeat center;\n    }\n  }\n}\n</style>\n"],"sourceRoot":""}]}