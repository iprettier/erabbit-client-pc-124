{"remainingRequest":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\goods\\index.vue?vue&type=style&index=0&id=3874315c&scoped=true&lang=less","dependencies":[{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\goods\\index.vue","mtime":1621243079000},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\css-loader\\dist\\cjs.js","mtime":1656924650500},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1656924654019},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\postcss-loader\\src\\index.js","mtime":1656924651883},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\less-loader\\dist\\cjs.js","mtime":1656924651368},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\style-resources-loader\\lib\\index.js","mtime":1656924651644},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656924649801},{"path":"F:\\代码\\Vue 代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1656924653036}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5nb29kcy1pbmZvIHsKICBtaW4taGVpZ2h0OiA2MDBweDsKICBiYWNrZ3JvdW5kOiAjZmZmOwogIGRpc3BsYXk6IGZsZXg7CiAgLm1lZGlhIHsKICAgIHdpZHRoOiA1ODBweDsKICAgIGhlaWdodDogNjAwcHg7CiAgICBwYWRkaW5nOiAzMHB4IDUwcHg7CiAgfQogIC5zcGVjIHsKICAgIGZsZXg6IDE7CiAgICBwYWRkaW5nOiAzMHB4IDMwcHggMzBweCAwOwogIH0KfQouZ29vZHMtZm9vdGVyIHsKICBkaXNwbGF5OiBmbGV4OwogIG1hcmdpbi10b3A6IDIwcHg7CiAgLmdvb2RzLWFydGljbGUgewogICAgd2lkdGg6IDk0MHB4OwogICAgbWFyZ2luLXJpZ2h0OiAyMHB4OwogIH0KICAuZ29vZHMtYXNpZGUgewogICAgd2lkdGg6IDI4MHB4OwogICAgbWluLWhlaWdodDogMTAwMHB4OwogIH0KfQovLyAuZ29vZHMtdGFicyB7Ci8vICAgbWluLWhlaWdodDogNjAwcHg7Ci8vICAgYmFja2dyb3VuZDogI2ZmZjsKLy8gfQovLyAuZ29vZHMtd2FybiB7Ci8vICAgbWluLWhlaWdodDogNjAwcHg7Ci8vICAgYmFja2dyb3VuZDogI2ZmZjsKLy8gICBtYXJnaW4tdG9wOiAyMHB4OwovLyB9Cg=="},{"version":3,"sources":["F:\\代码\\Vue 代码\\erabbit-client-pc-124\\src\\views\\goods\\index.vue"],"names":[],"mappings":"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","file":"F:/代码/Vue 代码/erabbit-client-pc-124/src/views/goods/index.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class='xtx-goods-page' v-if=\"goods\">\n    <div class=\"container\">\n      <!-- 面包屑 -->\n      <XtxBread>\n        <XtxBreadItem to=\"/\">首页</XtxBreadItem>\n        <XtxBreadItem :to=\"`/category/${goods.categories[1].id}`\">{{goods.categories[1].name}}</XtxBreadItem>\n        <XtxBreadItem :to=\"`/category/sub/${goods.categories[0].id}`\">{{goods.categories[0].name}}</XtxBreadItem>\n        <XtxBreadItem>{{goods.name}}</XtxBreadItem>\n      </XtxBread>\n      <!-- 商品信息 -->\n      <div class=\"goods-info\">\n        <div class=\"media\">\n          <GoodsImage :images=\"goods.mainPictures\" />\n          <GoodsSales />\n        </div>\n        <div class=\"spec\">\n          <GoodsName :goods=\"goods\" />\n          <!-- sku组件 skuId=\"1369155865461919746\" 测试选中 -->\n          <GoodsSku :goods=\"goods\" @change=\"changeSku\" />\n          <!-- 数量选择组件 -->\n          <XtxNumbox label=\"数量\" v-model=\"num\" :max=\"goods.inventory\" />\n          <!-- 按钮组件 -->\n          <XtxButton @click=\"insertCart()\" type=\"primary\" style=\"margin-top:20px\">加入购物车</XtxButton>\n        </div>\n      </div>\n      <!-- 商品推荐 -->\n      <GoodsRelevant :goodsId=\"goods.id\" />\n      <!-- 商品详情 -->\n      <div class=\"goods-footer\">\n        <div class=\"goods-article\">\n          <!-- 商品+评价 -->\n          <GoodsTabs />\n          <!-- 注意事项 -->\n          <GoodsWarn />\n        </div>\n        <!-- 24热榜+周热销榜 -->\n        <div class=\"goods-aside\">\n          <GoodsHot />\n          <GoodsHot :type=\"2\" />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport GoodsRelevant from './components/goods-relevant'\nimport GoodsImage from './components/goods-image'\nimport GoodsSales from './components/goods-sales'\nimport GoodsName from './components/goods-name'\nimport GoodsSku from './components/goods-sku'\nimport GoodsTabs from './components/goods-tabs'\nimport GoodsHot from './components/goods-hot'\nimport GoodsWarn from './components/goods-warn'\nimport { nextTick, provide, ref, watch } from 'vue'\nimport { findGoods } from '@/api/product'\nimport { useRoute } from 'vue-router'\nimport { useStore } from 'vuex'\nimport Message from '@/components/library/Message'\nexport default {\n  name: 'XtxGoodsPage',\n  components: { GoodsRelevant, GoodsImage, GoodsSales, GoodsName, GoodsSku, GoodsTabs, GoodsHot, GoodsWarn },\n  setup () {\n    const goods = useGoods()\n    const changeSku = (sku) => {\n      // 修改商品的现价原价库存信息\n      if (sku.skuId) {\n        goods.value.price = sku.price\n        goods.value.oldPrice = sku.oldPrice\n        goods.value.inventory = sku.inventory\n      }\n      // 记录选择后的sku，可能有数据，可能没有数据{}\n      currSku.value = sku\n    }\n\n    // 提供goods数据给后代组件使用\n    provide('goods', goods)\n\n    // 选择的数量\n    const num = ref(1)\n\n    // 加入购物车\n    const store = useStore()\n    const currSku = ref(null)\n    const insertCart = () => {\n      if (currSku.value && currSku.value.skuId) {\n        // id skuId name attrsText picture price nowPrice selected stock count isEffective\n        const { skuId, specsText: attrsText, inventory: stock } = currSku.value\n        const { id, name, price, mainPictures } = goods.value\n        store.dispatch('cart/insertCart', {\n          skuId,\n          attrsText,\n          stock,\n          id,\n          name,\n          price,\n          nowPrice: price,\n          picture: mainPictures[0],\n          selected: true,\n          isEffective: true,\n          count: num.value\n        }).then(() => {\n          Message({ type: 'success', text: '加入购物车成功' })\n        })\n      } else {\n        Message({ text: '请选择完整规格' })\n      }\n    }\n\n    return { goods, changeSku, num, insertCart }\n  }\n}\n// 获取商品详情\nconst useGoods = () => {\n  // 出现路由地址商品ID发生变化，但是不会重新初始化组件\n  const goods = ref(null)\n  const route = useRoute()\n  watch(() => route.params.id, (newVal) => {\n    if (newVal && `/product/${newVal}` === route.path) {\n      findGoods(route.params.id).then(data => {\n        // 让商品数据为null然后使用v-if的组件可以重新销毁和创建\n        goods.value = null\n        nextTick(() => {\n          goods.value = data.result\n        })\n      })\n    }\n  }, { immediate: true })\n  return goods\n}\n</script>\n\n<style scoped lang='less'>\n.goods-info {\n  min-height: 600px;\n  background: #fff;\n  display: flex;\n  .media {\n    width: 580px;\n    height: 600px;\n    padding: 30px 50px;\n  }\n  .spec {\n    flex: 1;\n    padding: 30px 30px 30px 0;\n  }\n}\n.goods-footer {\n  display: flex;\n  margin-top: 20px;\n  .goods-article {\n    width: 940px;\n    margin-right: 20px;\n  }\n  .goods-aside {\n    width: 280px;\n    min-height: 1000px;\n  }\n}\n// .goods-tabs {\n//   min-height: 600px;\n//   background: #fff;\n// }\n// .goods-warn {\n//   min-height: 600px;\n//   background: #fff;\n//   margin-top: 20px;\n// }\n</style>\n"]}]}