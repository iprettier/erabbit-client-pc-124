{"remainingRequest":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\src\\views\\category\\components\\sub-filter.vue?vue&type=style&index=0&id=134297f2&scoped=true&lang=less","dependencies":[{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\src\\views\\category\\components\\sub-filter.vue","mtime":1621243079000},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\css-loader\\dist\\cjs.js","mtime":1656924650500},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1656924654019},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\postcss-loader\\src\\index.js","mtime":1656924651883},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\less-loader\\dist\\cjs.js","mtime":1656924651368},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\style-resources-loader\\lib\\index.js","mtime":1656924651644},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1656924649801},{"path":"E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1656924653036}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgLy8g562b6YCJ5Yy6CiAgLnN1Yi1maWx0ZXIgewogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHBhZGRpbmc6IDI1cHg7CiAgICAuaXRlbSB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGxpbmUtaGVpZ2h0OiA0MHB4OwogICAgICAuaGVhZCB7CiAgICAgICAgd2lkdGg6IDgwcHg7CiAgICAgICAgY29sb3I6ICM5OTk7CiAgICAgIH0KICAgICAgLmJvZHkgewogICAgICAgIGZsZXg6IDE7CiAgICAgICAgYSB7CiAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDM2cHg7CiAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgLjNzOwogICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgICAgICAgJi5hY3RpdmUsCiAgICAgICAgICAmOmhvdmVyIHsKICAgICAgICAgICAgY29sb3I6IEB4dHhDb2xvcjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC54dHgtc2tlbGV0b24gewogICAgICBwYWRkaW5nOiAxMHB4IDA7CiAgICB9CiAgfQo="},{"version":3,"sources":["E:\\百度网盘下载\\黑马vue\\Vue3.0小兔鲜儿项目资料\\代码\\erabbit-client-pc-124\\src\\views\\category\\components\\sub-filter.vue"],"names":[],"mappings":";EA4FE,CAAC,EAAE,CAAC,CAAC;EACL,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACb,CAAC,CAAC,CAAC,CAAC,EAAE;MACJ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;MACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;MACjB,CAAC,CAAC,CAAC,CAAC,EAAE;QACJ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACX,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;MACb;MACA,CAAC,CAAC,CAAC,CAAC,EAAE;QACJ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;QACP,EAAE;UACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;UAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;UACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UACrB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UACR,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;YACN,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UAClB;QACF;MACF;IACF;IACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;IACjB;EACF","file":"E:/百度网盘下载/黑马vue/Vue3.0小兔鲜儿项目资料/代码/erabbit-client-pc-124/src/views/category/components/sub-filter.vue","sourceRoot":"","sourcesContent":["<template>\n  <div class=\"sub-filter\" v-if=\"filterData && !filterLoading\">\n    <div class=\"item\">\n      <div class=\"head\">品牌：</div>\n      <div class=\"body\">\n        <a @click=\"changeBrand(item.id)\" :class=\"{active:item.id===filterData.selectedBrand}\" href=\"javascript:;\" v-for=\"item in filterData.brands\" :key=\"item.id\">{{item.name}}</a>\n      </div>\n    </div>\n    <div class=\"item\" v-for=\"item in filterData.saleProperties\" :key=\"item.id\">\n      <div class=\"head\">{{item.name}}：</div>\n      <div class=\"body\">\n        <a @click=\"changeProp(item,prop.id)\" :class=\"{active:prop.id===item.selectedProp}\" href=\"javascript:;\" v-for=\"prop in item.properties\" :key=\"prop.id\">{{prop.name}}</a>\n      </div>\n    </div>\n  </div>\n  <div v-else class=\"sub-filter\">\n    <XtxSkeleton class=\"item\" width=\"800px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"800px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"600px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"600px\" height=\"40px\"  />\n    <XtxSkeleton class=\"item\" width=\"600px\" height=\"40px\"  />\n  </div>\n</template>\n<script>\nimport { ref, watch } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { findSubCategoryFilter } from '@/api/category'\nexport default {\n  name: 'SubFilter',\n  setup (props, { emit }) {\n    const route = useRoute()\n    // 监听二级类目ID的变化获取筛选数据\n    const filterData = ref(null)\n    const filterLoading = ref(false)\n    watch(() => route.params.id, (newVal) => {\n      // 变化后的ID有值 且 处在二级类名路由下\n      if (newVal && `/category/sub/${newVal}` === route.path) {\n        filterLoading.value = true\n        // 发请求获取数据\n        findSubCategoryFilter(route.params.id).then(data => {\n          // 每一组可选的筛选条件缺失 全部 条件，处理下数据加上全部\n          // 给每一组数据加上一个选中的ID\n          // 1. 品牌\n          data.result.selectedBrand = null\n          data.result.brands.unshift({ id: null, name: '全部' })\n          // 2. 属性\n          data.result.saleProperties.forEach(item => {\n            item.selectedProp = null\n            item.properties.unshift({ id: null, name: '全部' })\n          })\n          // 设置修改的数据\n          filterData.value = data.result\n          filterLoading.value = false\n        })\n      }\n    }, { immediate: true })\n\n    // 获取筛选参数的函数\n    const getFilterParams = () => {\n      const obj = { brandId: null, attrs: [] }\n      // 品牌\n      obj.brandId = filterData.value.selectedBrand\n      // 销售属性\n      filterData.value.saleProperties.forEach(item => {\n        if (item.selectedProp) {\n          const prop = item.properties.find(prop => prop.id === item.selectedProp)\n          obj.attrs.push({ groupName: item.name, propertyName: prop.name })\n        }\n      })\n      // 参考数据：{brandId:'',attrs:[{groupName:'',propertyName:''},...]}\n      if (obj.attrs.length === 0) obj.attrs = null\n      return obj\n    }\n\n    // 1. 记录当前选择的品牌\n    const changeBrand = (brandId) => {\n      if (filterData.value.selectedBrand === brandId) return\n      filterData.value.selectedBrand = brandId\n      emit('filter-change', getFilterParams())\n    }\n    // 2. 记录呢选择的销售属性\n    const changeProp = (item, propId) => {\n      if (item.selectedProp === propId) return\n      item.selectedProp = propId\n      emit('filter-change', getFilterParams())\n    }\n\n    return { filterData, filterLoading, changeBrand, changeProp }\n  }\n}\n</script>\n<style scoped lang='less'>\n  // 筛选区\n  .sub-filter {\n    background: #fff;\n    padding: 25px;\n    .item {\n      display: flex;\n      line-height: 40px;\n      .head {\n        width: 80px;\n        color: #999;\n      }\n      .body {\n        flex: 1;\n        a {\n          margin-right: 36px;\n          transition: all .3s;\n          display: inline-block;\n          &.active,\n          &:hover {\n            color: @xtxColor;\n          }\n        }\n      }\n    }\n    .xtx-skeleton {\n      padding: 10px 0;\n    }\n  }\n</style>\n"]}]}